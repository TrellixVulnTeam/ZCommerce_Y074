{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport User from '../models/userModel';\n\nconst auth = async (req, res) => {\n  console.log(req.headers.authorization);\n  const token = req.headers.authorization;\n  if (!token) return res.status(400).json({\n    err: 'Invalid Auth'\n  });\n  const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET);\n  if (!decoded) return res.status(400).json({\n    err: 'Invalid Auth'\n  });\n  const user = await User.findOne({\n    _id: decoded.id\n  });\n  return {\n    id: user._id\n  };\n};\n\nexport default auth;","map":{"version":3,"sources":["/home/zuares/Documents/Project/ZCommerce/middleware/auth.js"],"names":["jwt","User","auth","req","res","console","log","headers","authorization","token","status","json","err","decoded","verify","process","env","ACCESS_TOKEN_SECRET","user","findOne","_id","id"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,OAAOC,IAAP,MAAiB,qBAAjB;;AAEA,MAAMC,IAAI,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC7BC,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAACI,OAAJ,CAAYC,aAAxB;AACA,QAAMC,KAAK,GAAGN,GAAG,CAACI,OAAJ,CAAYC,aAA1B;AACA,MAAI,CAACC,KAAL,EAAY,OAAOL,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAArB,CAAP;AAEZ,QAAMC,OAAO,GAAGb,GAAG,CAACc,MAAJ,CAAWL,KAAX,EAAkBM,OAAO,CAACC,GAAR,CAAYC,mBAA9B,CAAhB;AACA,MAAI,CAACJ,OAAL,EAAc,OAAOT,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAArB,CAAP;AAEd,QAAMM,IAAI,GAAG,MAAMjB,IAAI,CAACkB,OAAL,CAAa;AAAEC,IAAAA,GAAG,EAAEP,OAAO,CAACQ;AAAf,GAAb,CAAnB;AACA,SAAO;AAAEA,IAAAA,EAAE,EAAEH,IAAI,CAACE;AAAX,GAAP;AACH,CAVD;;AAaA,eAAelB,IAAf","sourcesContent":["import jwt from 'jsonwebtoken'\nimport User from '../models/userModel'\n\nconst auth = async (req, res) => {\n    console.log(req.headers.authorization);\n    const token = req.headers.authorization\n    if (!token) return res.status(400).json({ err: 'Invalid Auth' })\n\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET)\n    if (!decoded) return res.status(400).json({ err: 'Invalid Auth' })\n\n    const user = await User.findOne({ _id: decoded.id })\n    return { id: user._id }\n}\n\n\nexport default auth"]},"metadata":{},"sourceType":"module"}